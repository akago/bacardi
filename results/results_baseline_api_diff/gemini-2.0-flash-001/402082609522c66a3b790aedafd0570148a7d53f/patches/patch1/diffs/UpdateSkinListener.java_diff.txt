12d11
< import org.spongepowered.api.Platform.Type;
14d12
< import org.spongepowered.api.command.CommandSource;
17,18c15,16
< import org.spongepowered.api.network.RawDataListener;
< import org.spongepowered.api.network.RemoteConnection;
---
> import org.spongepowered.api.network.Connection;
> import org.spongepowered.api.network.MessageHandler;
19a18
> import org.spongepowered.api.util.bytebuf.ByteBufView;
21c20
< public class UpdateSkinListener implements RawDataListener {
---
> public class UpdateSkinListener implements MessageHandler<ChannelBuf> {
27,28c26,31
<     public void handlePayload(ChannelBuf data, RemoteConnection connection, Type side) {
<         ByteArrayDataInput dataInput = ByteStreams.newDataInput(data.array());
---
>     public void handleMessage(ChannelBuf data, Connection connection) {
>         ByteBufView buffer = data.asView();
>         byte[] array = new byte[buffer.readableBytes()];
>         buffer.readBytes(array);
> 
>         ByteArrayDataInput dataInput = ByteStreams.newDataInput(array);
35,36c38,39
<             Runnable skinUpdater = new SkinApplier(plugin, (CommandSource) connection, receiver.get(), null, false);
<             Task.builder().execute(skinUpdater).submit(plugin);
---
>             Runnable skinUpdater = new SkinApplier(plugin, (Player) connection, receiver.get(), null, false);
>             Task.builder().execute(skinUpdater).plugin(plugin).submit(plugin);
