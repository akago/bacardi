12d11
< import redis.clients.jedis.Client;
13a13,14
> import redis.clients.jedis.JedisMulti;
> import redis.clients.jedis.JedisPipeline;
98,101c99,101
<         } catch (JRedisGraphException rt) {
<             throw rt;
<         } catch (JedisDataException j) {
<             throw new JRedisGraphException(j);
---
>         } catch (Exception e) {
>             conn.close();
>             throw e;
118c118
<                     graphId, preparedQuery, Utils.COMPACT_STRING, Utils.TIMEOUT_STRING, Long.toString(timeout));
---
>                     graphId, preparedQuery, Utils.COMPACT_STRING, Utils.TIMEOUT_STRING, Long.toString(timeout);
120,123c120,122
<         } catch (JRedisGraphException ge) {
<             throw ge;
<         } catch (JedisDataException de) {
<             throw new JRedisGraphException(de);
---
>         } catch (Exception e) {
>             conn.close();
>             throw e;
139d137
<     @Override
142,145c140,141
<         Client client = jedis.getClient();
<         client.multi();
<         client.getOne();
<         RedisGraphTransaction transaction = new RedisGraphTransaction(client, this);
---
>         JedisMulti multi = jedis.multi();
>         RedisGraphTransaction transaction = new RedisGraphTransaction(multi, this);
154d149
<     @Override
157,160c152,155
<         Client client = jedis.getClient();
<         RedisGraphPipeline pipeline = new RedisGraphPipeline(client, this);
<         pipeline.setRedisGraphCaches(caches);
<         return pipeline;
---
>         JedisPipeline pipeline = jedis.pipelined();
>         RedisGraphPipeline redisGraphPipeline = new RedisGraphPipeline(pipeline, this);
>         redisGraphPipeline.setRedisGraphCaches(caches);
>         return redisGraphPipeline;
208d202
< 
215d208
< 
