9c9,11
< import com.artipie.asto.factory.Storages;
---
> import com.artipie.asto.factory.Config;
> import com.artipie.asto.factory.StorageFactory;
> import com.artipie.asto.factory.StorageConfig;
11a14,15
> import java.util.ServiceLoader;
> import java.util.stream.StreamSupport;
40a45,52
>             final String type = sub.string("type");
>             final Config yamlConfig = new Config.Yaml(Yaml.createYamlInput(sub.toString()).readYamlMapping());
>             final StorageFactory storageFactory = StreamSupport.stream(
>                     ServiceLoader.load(StorageFactory.class).spliterator(), false
>                 ).filter(factory -> factory.getClass().getSimpleName().replace("Factory", "").equalsIgnoreCase(type))
>                 .findFirst().orElseThrow(() -> new IllegalArgumentException(
>                     String.format("Storage '%s' not found in classpath", type)
>                 ));
43,45c55
<                     new Storages().newStorage(
<                         sub.string("type"), Yaml.createYamlInput(sub.toString()).readYamlMapping()
<                     )
---
>                     storageFactory.newStorage(yamlConfig)
