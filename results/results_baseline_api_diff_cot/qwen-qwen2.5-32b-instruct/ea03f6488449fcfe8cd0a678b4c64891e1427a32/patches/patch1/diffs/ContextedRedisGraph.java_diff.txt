10,12c10,11
< import com.redislabs.redisgraph.impl.resultset.ResultSetImpl;
< 
< import redis.clients.jedis.Client;
---
> import com.redislabs.redisgraph.impl.transaction.RedisGraphPipeline;
> import com.redislabs.redisgraph.impl.transaction.RedisGraphTransaction;
13a13,14
> import redis.clients.jedis.JedisClientConfig;
> import redis.clients.jedis.JedisPool;
15d15
< import redis.clients.jedis.util.SafeEncoder;
56,59c56,58
<         } catch (JRedisGraphException rt) {
<             throw rt;
<         } catch (JedisDataException j) {
<             throw new JRedisGraphException(j);
---
>         } catch (Exception e) {
>             conn.close();
>             throw e;
76,79c75,77
<         } catch (JRedisGraphException ge) {
<             throw ge;
<         } catch (JedisDataException de) {
<             throw new JRedisGraphException(de);
---
>         } catch (Exception e) {
>             conn.close();
>             throw e;
86d83
<      * @param timeout
87a85
>      * @param timeout
98,101c96,98
<         } catch (JRedisGraphException rt) {
<             throw rt;
<         } catch (JedisDataException j) {
<             throw new JRedisGraphException(j);
---
>         } catch (Exception e) {
>             conn.close();
>             throw e;
108d104
<      * @param timeout
109a106
>      * @param timeout
120,123c117,119
<         } catch (JRedisGraphException ge) {
<             throw ge;
<         } catch (JedisDataException de) {
<             throw new JRedisGraphException(de);
---
>         } catch (Exception e) {
>             conn.close();
>             throw e;
142,145c138,139
<         Client client = jedis.getClient();
<         client.multi();
<         client.getOne();
<         RedisGraphTransaction transaction = new RedisGraphTransaction(client, this);
---
>         // Directly use Jedis for transaction, as Client class is no longer available
>         RedisGraphTransaction transaction = new RedisGraphTransaction(jedis, this);
157,158c151,152
<         Client client = jedis.getClient();
<         RedisGraphPipeline pipeline = new RedisGraphPipeline(client, this);
---
>         // Directly use Jedis for pipeline, as Client class is no longer available
>         RedisGraphPipeline pipeline = new RedisGraphPipeline(jedis, this);
208d201
< 
215d207
< 
