30d29
< import org.acegisecurity.providers.encoding.PasswordEncoder;
33c32,33
< import org.jasypt.spring.security.PBEPasswordEncoder;
---
> import org.jasypt.spring.security3.PBEStringEncryptor;
> 
89c89
<         protected PasswordEncoder createStringEncoder() {
---
>         protected PBEStringEncryptor createStringEncoder() {
102,105c102
<                         PBEPasswordEncoder encoder = new PBEPasswordEncoder();
<                         encoder.setPbeStringEncryptor(stringEncrypter);
< 
<                         return encoder;
---
>                         return stringEncrypter;
129c126
<                                 byte[] decoded = Base64.getDecoder().decode(encPass.getBytes());
---
>                                 byte[] decoded = Base64.getDecoder().decode(removePrefix(encPass).getBytes());
178c175
<                         getStringEncoder();
---
>                         createStringEncoder();
189c186
<                         getCharEncoder();
---
>                         createCharEncoder();
