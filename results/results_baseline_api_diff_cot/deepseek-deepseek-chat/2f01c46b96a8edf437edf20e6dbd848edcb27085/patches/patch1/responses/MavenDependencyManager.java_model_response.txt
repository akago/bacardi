```java
package se.kth.depclean.wrapper;

import static com.google.common.collect.ImmutableSet.of;

import java.io.File;
import java.io.FileReader;
import java.io.IOException;
import java.io.Serializable;
import java.nio.file.Path;
import java.nio.file.Paths;
import java.util.Arrays;
import java.util.HashSet;
import java.util.Optional;
import java.util.Set;
import java.util.stream.Collectors;
import lombok.AllArgsConstructor;
import lombok.SneakyThrows;
import org.apache.maven.execution.MavenSession;
import org.apache.maven.model.Model;
import org.apache.maven.model.io.xpp3.MavenXpp3Reader;
import org.apache.maven.plugin.logging.Log;
import org.apache.maven.project.DefaultProjectBuildingRequest;
import org.apache.maven.project.MavenProject;
import org.apache.maven.project.ProjectBuildingRequest;
import org.apache.maven.shared.dependency.graph.DependencyGraphBuilder;
import org.apache.maven.shared.dependency.graph.DependencyNode;
import org.apache.maven.plugin.Plugin;
import org.apache.maven.plugin.PluginExecution;
import org.apache.maven.plugin.PluginParameterExpressionEvaluator;
import org.apache.maven.plugin.descriptor.PluginDescriptor;
import org.apache.maven.plugin.descriptor.PluginDescriptorBuilder;
import org.apache.maven.plugin.descriptor.PluginParameter;
import org.apache.maven.plugin.descriptor.PluginParameterBuilder;
import org.apache.maven.plugin.descriptor.PluginParameterExpressionEvaluatorBuilder;
import org.apache.maven.plugin.descriptor.PluginParameterExpressionEvaluatorBuilder.PluginParameterExpressionEvaluatorBuilderResult;
import org.apache.maven.plugin.descriptor.PluginParameterExpressionEvaluatorBuilder.PluginParameterExpressionEvaluatorBuilderResult.PluginParameterExpressionEvaluatorBuilderResultBuilder;
import org.apache.maven.plugin.descriptor.PluginParameterExpressionEvaluatorBuilder.PluginParameterExpressionEvaluatorBuilderResult.PluginParameterExpressionEvaluatorBuilderResultBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilder;
import org.apache.maven.plugin.descriptor.PluginParameterExpressionEvaluatorBuilder.PluginParameterExpressionEvaluatorBuilderResult.PluginParameterExpressionEvaluatorBuilderResultBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilderBuilder;
import org.apache.maven.plugin.descriptor.PluginParameterExpressionEvaluatorBuilder.PluginParameterExpressionEvaluatorBuilderResult.PluginParameterExpressionEvaluatorBuilderResultBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilderBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilderBuilderBuilder;
import org.apache.maven.plugin.descriptor.PluginParameterExpressionEvaluatorBuilder.PluginParameterExpressionEvaluatorBuilderResult.PluginParameterExpressionEvaluatorBuilderResultBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilderBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilderBuilderBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilderBuilderBuilderBuilder;
import org.apache.maven.plugin.descriptor.PluginParameterExpressionEvaluatorBuilder.PluginParameterExpressionEvaluatorBuilderResult.PluginParameterExpressionEvaluatorBuilderResultBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilderBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilderBuilderBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilderBuilderBuilderBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilderBuilderBuilderBuilderBuilder;
import org.apache.maven.plugin.descriptor.PluginParameterExpressionEvaluatorBuilder.PluginParameterExpressionEvaluatorBuilderResult.PluginParameterExpressionEvaluatorBuilderResultBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilderBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilderBuilderBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilderBuilderBuilderBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilderBuilderBuilderBuilderBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilder;
import org.apache.maven.plugin.descriptor.PluginParameterExpressionEvaluatorBuilder.PluginParameterExpressionEvaluatorBuilderResult.PluginParameterExpressionEvaluatorBuilderResultBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilderBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilderBuilderBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilderBuilderBuilderBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilderBuilderBuilderBuilderBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilder;
import org.apache.maven.plugin.descriptor.PluginParameterExpressionEvaluatorBuilder.PluginParameterExpressionEvaluatorBuilderResult.PluginParameterExpressionEvaluatorBuilderResultBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilderBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilderBuilderBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilderBuilderBuilderBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilderBuilderBuilderBuilderBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilder;
import org.apache.maven.plugin.descriptor.PluginParameterExpressionEvaluatorBuilder.PluginParameterExpressionEvaluatorBuilderResult.PluginParameterExpressionEvaluatorBuilderResultBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilderBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilderBuilderBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilderBuilderBuilderBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilderBuilderBuilderBuilderBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilder;
import org.apache.maven.plugin.descriptor.PluginParameterExpressionEvaluatorBuilder.PluginParameterExpressionEvaluatorBuilderResult.PluginParameterExpressionEvaluatorBuilderResultBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilderBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilderBuilderBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilderBuilderBuilderBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilderBuilderBuilderBuilderBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilder;
import org.apache.maven.plugin.descriptor.PluginParameterExpressionEvaluatorBuilder.PluginParameterExpressionEvaluatorBuilderResult.PluginParameterExpressionEvaluatorBuilderResultBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilderBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilderBuilderBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilderBuilderBuilderBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilderBuilderBuilderBuilderBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilder;
import org.apache.maven.plugin.descriptor.PluginParameterExpressionEvaluatorBuilder.PluginParameterExpressionEvaluatorBuilderResult.PluginParameterExpressionEvaluatorBuilderResultBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilderBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilderBuilderBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilderBuilderBuilderBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilderBuilderBuilderBuilderBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilder;
import org.apache.maven.plugin.descriptor.PluginParameterExpressionEvaluatorBuilder.PluginParameterExpressionEvaluatorBuilderResult.PluginParameterExpressionEvaluatorBuilderResultBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilderBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilderBuilderBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilderBuilderBuilderBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilderBuilderBuilderBuilderBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilder.PluginParameterExpressionEvaluatorBuilderResultBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilderBuilder;
import org.apache.maven.plugin.descriptor.PluginParameterExpressionEvaluatorBuilder.PluginParameterExpressionEvaluatorBuilderResult.PluginParameterExpressionEvaluatorBuilderResultBuilder.Pl
