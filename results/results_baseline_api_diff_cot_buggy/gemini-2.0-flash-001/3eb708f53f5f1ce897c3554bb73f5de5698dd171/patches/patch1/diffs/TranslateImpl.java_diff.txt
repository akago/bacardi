23,25d22
< import com.google.api.services.translate.model.DetectionsResourceItems;
< import com.google.api.services.translate.model.LanguagesResource;
< import com.google.api.services.translate.model.TranslationsResource;
37a35
> import java.util.function.Function;
43,51d40
<   private static final Function<List<DetectionsResourceItems>, Detection>
<       DETECTION_FROM_PB_FUNCTION =
<           new Function<List<DetectionsResourceItems>, Detection>() {
<             @Override
<             public Detection apply(List<DetectionsResourceItems> detectionPb) {
<               return Detection.fromPb(detectionPb.get(0));
<             }
<           };
< 
60,64d48
<       return Lists.transform(
<           runWithRetries(
<               new Callable<List<LanguagesResource>>() {
<                 @Override
<                 public List<LanguagesResource> call() {
66,71d49
<                 }
<               },
<               getOptions().getRetrySettings(),
<               EXCEPTION_HANDLER,
<               getOptions().getClock()),
<           Language.FROM_PB_FUNCTION);
80c58
<       List<List<DetectionsResourceItems>> detectionsPb =
---
>       List<String> detectionsPb =
82c60
<               new Callable<List<List<DetectionsResourceItems>>>() {
---
>               new Callable<List<String>>() {
84c62
<                 public List<List<DetectionsResourceItems>> call() {
---
>                 public List<String> call() {
91,100c69,70
<       Iterator<List<DetectionsResourceItems>> detectionIterator = detectionsPb.iterator();
<       Iterator<String> textIterator = texts.iterator();
<       while (detectionIterator.hasNext() && textIterator.hasNext()) {
<         List<DetectionsResourceItems> detectionPb = detectionIterator.next();
<         String text = textIterator.next();
<         checkState(
<             detectionPb != null && !detectionPb.isEmpty(), "No detection found for text: %s", text);
<         checkState(detectionPb.size() == 1, "Multiple detections found for text: %s", text);
<       }
<       return Lists.transform(detectionsPb, DETECTION_FROM_PB_FUNCTION);
---
> 
>       return Lists.transform(detectionsPb, Detection::new);
119,123d88
<       return Lists.transform(
<           runWithRetries(
<               new Callable<List<TranslationsResource>>() {
<                 @Override
<                 public List<TranslationsResource> call() {
125,130d89
<                 }
<               },
<               getOptions().getRetrySettings(),
<               EXCEPTION_HANDLER,
<               getOptions().getClock()),
<           Translation.FROM_PB_FUNCTION);
